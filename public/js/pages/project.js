"use strict";(function(){dependenciesLoader(["React","ReactDOM","Synchronise","Typeahead","Loader","ProjectModalInfo","ProjectModalTeam","ProjectModalStore"],function(){var i=React.createClass({displayName:"ProjectsList",getInitialState:function n(){return{projects:[],loading:true}},componentDidMount:function k(){var o=this;Synchronise.Cloud.run("projectList",{realtime:true},{success:function p(q){var r=_.each(q,function(s){if(!s.icon){s.icon="https://images.synchronise.io/defaultProjectIcon.png"}});o.setState({projects:r,loading:false})}});Synchronise.Cloud.run("getUserConnections",{realtime:true,user_object:true},{success:function p(q){_.each(q,function(r){r.text=r.name+" ("+r.email+")";r.value=r.email});if(o.isMounted()){o.setState({listOfKnownPeople:q})}}});if(urlH.getParam("displayModalCreate")){a(false)}},createProject:function l(){a(false)},render:function c(){var p=this;var q="";if(this.state.loading){q=React.createElement(Loader,null)}var o="";if(this.state.projects.length||this.state.loading){o=React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},React.createElement("hr",null),React.createElement("br",null)))}return React.createElement("div",null,React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},React.createElement("center",null,React.createElement("p",null,"All the components and workflows you create on Synchronise can stored in a ",React.createElement("b",null,"project"),". You can add your colleagues to a project to give them access to the components and worflows you created.")),React.createElement("br",null),React.createElement("center",null,React.createElement("button",{className:"btn btn-primary cbutton cbutton--effect-novak",onClick:this.createProject},"Create new project")))),o,React.createElement("div",{className:""},React.createElement("div",{className:"row projectsList",align:"center"},q,this.state.projects.map(function(r){return React.createElement(m,{id_project:r.id,description:r.description,icon:r.icon,url:r.url,name:r.name,permissions:r.permissions,key:"project"+r.id,knownUsers:p.state.listOfKnownPeople})}))))}});var m=React.createClass({displayName:"ProjectBlock",getInitialState:function n(){return{contentClassName:""}},settings:function g(){a(this.props.id_project,"info",this.props.permissions,this.props.knownUsers)},team:function e(){a(this.props.id_project,"team",this.props.permissions,this.props.knownUsers)},"delete":function h(){var p=this;var o=$(ReactDOM.findDOMNode(p));new ModalConfirm("You are about to delete this project. This include all the queries attached to it and any other material that you have created. Are you sure you want to do this ?",function(r){if(r){o.animate({opacity:0.5},300);Synchronise.Cloud.run("removeProject",{id_project:p.props.id_project},{success:function s(){o.animate({width:"0px",opacity:0},300)},error:function q(t){o.animate({opacity:1},300);new ModalErrorParse(t).title("Removing project")}})}})},componentDidMount:function k(){this.setState({contentClassName:"display"});console.log(ReactDOM.findDOMNode(this));var o=$(ReactDOM.findDOMNode(this)).find(".icon");o.css("opacity","0");$(o).load(function(){$(this).animate({opacity:1},500)})},openProjectUrl:function d(){var o=this.props.url;if(o.indexOf("http://")==-1&&o.indexOf("https://")==-1){o="http://"+o}window.open(o,"_blank")},render:function c(){var q="";if(this.props.description){q=React.createElement("small",{className:"hidden-xs"},this.props.description)}var o="";if(this.props.url){o=React.createElement("small",{className:"hidden-xs"},React.createElement("a",{onClick:this.openProjectUrl,target:"_blank"},this.props.url))}var r="";var p="";if(this.props.permissions.own){r=React.createElement("div",{className:"delete",onClick:this["delete"]},React.createElement("i",{className:"fa fa-trash"}))}else{p=React.createElement("div",{className:"isSharedRibbon"})}return React.createElement("div",{className:"col-lg-3 col-md-4 col-sm-6 col-xs-12 project",align:"center"},React.createElement("div",{className:"content card "+this.state.contentClassName},React.createElement("div",{className:"settings",onClick:this.settings},React.createElement("i",{className:"fa fa-cog"})),r,React.createElement("div",{className:"team",onClick:this.team},React.createElement("i",{className:"fa fa-users"})),React.createElement("img",{className:"icon",src:this.props.icon}),React.createElement("h3",null,this.props.name),q,o,p))}});function a(s,p,o,q){var r={info:"active",team:"",store:""};o=o||{view:true,edit:true,own:true};if(typeof p!="undefined"){_.each(Object.keys(r),function(t){r[t]=""});r[p]="active"}ReactDOM.render(React.createElement(f,{id_project:s,title:"Project",tabsState:r,permissions:o,knownUsers:q}),document.getElementById("projectModal"))}var f=React.createClass({displayName:"ProjectModal",getInitialState:function n(){return{componentDisplayed:false}},componentDidMount:function k(){var p=this;$(ReactDOM.findDOMNode(p).parentNode).bind("click touchstart",function(q){if(q.target.id=="projectModal"){p.closeModal()}});KeyEventController.subscribeComponent("collectInputForProjectAndReturn",function(q){if(q==27){p.closeModal()}});$(ReactDOM.findDOMNode(p).parentNode).addClass("fadeInBackground");var o=window.setTimeout(function(){$(ReactDOM.findDOMNode(p)).addClass("slideInProject");window.clearTimeout(o)},300)},closeModal:function j(){var o=this;if(o.isMounted()){$(ReactDOM.findDOMNode(o)).addClass("slideOutProject");window.setTimeout(function(){$(ReactDOM.findDOMNode(o).parentNode).addClass("fadeOutBackground");window.setTimeout(function(){$(ReactDOM.findDOMNode(o).parentNode).removeClass("fadeOutBackground fadeInBackground");ReactDOM.unmountComponentAtNode(ReactDOM.findDOMNode(o).parentNode)},500)},300);KeyEventController.unsubscribeComponent("collectInputForProjectAndReturn")}},render:function c(){var o="";if(this.props.id_project){o=React.createElement(b,{tabsState:this.props.tabsState})}var p=React.createElement("div",{className:"tab-content"},React.createElement(ProjectModalInfo,{state:this.props.tabsState.info,id_project:this.props.id_project,closeModal:this.closeModal,permissions:this.props.permissions,validateButtonLabel:"Save",validateButtonLabelActive:"Saving ..."}),React.createElement(ProjectModalTeam,{state:this.props.tabsState.team,permissions:this.props.permissions,id_project:this.props.id_project,closeModal:this.closeModal,knownUsers:this.props.knownUsers}),React.createElement(ProjectModalStore,{state:this.props.tabsState.store,permissions:this.props.permissions,id_project:this.props.id_project,closeModal:this.closeModal}));return React.createElement("div",{className:"content",ref:"projectModal"},React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},React.createElement("i",{className:"fa fa-times pull-right",onClick:this.closeModal}))),React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},React.createElement("legend",null,this.props.title))),o," ",p)}});var b=React.createClass({displayName:"TabsForProjectModal",render:function c(){var q=this.props.tabsState.info;var p=this.props.tabsState.team;var o=this.props.tabsState.store;return React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12 tabsModal"},React.createElement("ul",{className:"nav nav-tabs",role:"tablist"},React.createElement("li",{role:"projectModal",className:q},React.createElement("a",{href:"#info","aria-controls":"info",role:"tab","data-toggle":"tab"},"Info")),React.createElement("li",{role:"projectModal",className:p},React.createElement("a",{href:"#team","aria-controls":"team",role:"tab","data-toggle":"tab"},"Team")),React.createElement("li",{role:"projectModal",className:o},React.createElement("a",{href:"#store","aria-controls":"store",role:"tab","data-toggle":"tab"},"Marketplace"))))}});ReactDOM.render(React.createElement(i,null),document.getElementById("projectsList"))})})();