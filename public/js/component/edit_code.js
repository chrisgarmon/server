"use strict";var Code;dependenciesLoader(["$","React","ReactDOM","_","Loader","TimeAgo","CodeMirror","urlH"],function(){var a=window.setInterval(function(){if(typeof CodeMirror.modes.javascript!="undefined"){b();window.clearInterval(a)}},0);function b(){var e=React.createClass({displayName:"Inputs",getInitialState:function d(){return{}},componentDidMount:function i(){},render:function g(){return React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},React.createElement("legend",null,"Inputs"),React.createElement("div",{className:"well inline-form"},React.createElement("a",{className:"input"},React.createElement("select",{className:"form-control input-xs type"},React.createElement("option",null,"text"),React.createElement("option",null,"number"),React.createElement("option",null,"date"),React.createElement("option",null,"boolean")),React.createElement("span",{className:"label label-primary name"},"id_user")),React.createElement("a",{className:"input"},React.createElement("select",{className:"form-control input-xs type"},React.createElement("option",null,"text"),React.createElement("option",null,"number"),React.createElement("option",null,"date"),React.createElement("option",null,"boolean")),React.createElement("span",{className:"label label-primary name"},"email")),React.createElement("a",{className:"input"},React.createElement("select",{className:"form-control input-xs type"},React.createElement("optgroup",{label:"Text"},React.createElement("option",{value:"text"},"Text"),React.createElement("option",{value:"email"},"Email"),React.createElement("option",{value:"telephone"},"Telephone number"),React.createElement("option",{value:"postcode"},"Post code"),React.createElement("option",{value:"url"},"URL"),React.createElement("option",{value:"color"},"HEX Color")),React.createElement("option",null,"number"),React.createElement("option",null,"date"),React.createElement("option",null,"boolean")),React.createElement("span",{className:"label label-primary name"},"name"))))}});Code=React.createClass({displayName:"Code",getInitialState:function d(){return{component:false,saving:false,name:"",loading:false,code:"",codeMirror:false,error:false}},componentDidMount:function i(){var m=this;m.setState({loading:true});function l(p,y){for(var A=0;A<p.length;A++){var w=p[A];if(w){var z,u;if((z=[],w.evidence)){var q=z[w.line];if(!q){var C=w.evidence;q=[],Array.prototype.forEach.call(C,function(o,s){"	"===o&&q.push(s+1)}),z[w.line]=q}if(q.length>0){var D=w.character;q.forEach(function(o){D>o&&(D-=1)}),w.character=D}}var B=w.character-1,x=B+1;w.evidence&&(u=w.evidence.substring(B).search(/.\b/),u>-1&&(x+=u)),w.description=w.reason,w.start=w.character,w.end=x,y.push({message:w.description,severity:w.severity,from:CodeMirror.Pos(w.line-1,B),to:CodeMirror.Pos(w.line-1,x)})}}}CodeMirror.registerHelper("lint","javascript",function(q,p){if(!window.JSHINT){return[]}JSHINT(q,p,p.globals);var r=JSHINT.data().errors,o=[];if(r){l(r,o)}return o});var k=CodeMirror.fromTextArea(document.getElementById("code"),{mode:"javascript",theme:"material",lineNumbers:true,autofocus:true,tabSize:6,gutters:["CodeMirror-lint-markers"],lint:true});k.on("change",m.codeChanged);Synchronise.Cloud.run("loadComponent",{id:urlH.getParam("id")},{success:function n(o){m.setState({component:o,name:o.name});k.setValue(o.code)},always:function j(){m.setState({loading:false})}});this.setState({codeMirror:k})},nameChanged:function h(j){var k=this;k.setState({name:j.target.value});Synchronise.Cloud.run("updateComponent",{id:urlH.getParam("id"),data:{name:j.target.value}},{success:function l(m){k.setState({component:m,lastUpdate:new Date()})}})},onFocusIdentifier:function f(j){$(j.target).select()},codeChanged:function c(l){var m=this;m.setState({code:l.getValue(),saving:true});Synchronise.Cloud.run("updateComponent",{id:urlH.getParam("id"),data:{code:l.getValue()}},{success:function n(){m.setState({error:false})},always:function j(){m.setState({saving:false})},error:function k(o){m.setState({error:o.err})}})},render:function g(){var k="";if(!this.state.loading){if(this.state.saving){k=React.createElement("span",{className:"label label-primary",style:{position:"absolute",right:"19px",marginTop:"-35px"}},"Saving")}else{if(!this.state.error){k=React.createElement("span",{className:"label label-success",style:{position:"absolute",right:"19px",marginTop:"-35px"}},"Saved")}else{k=React.createElement("span",{className:"label label-danger",style:{position:"absolute",right:"19px",marginTop:"-35px"}},"Syntax error")}}}var l=React.createElement(Loader,null);if(!this.state.loading){l=React.createElement("div",{className:"col-lg-8 col-md-8 col-sm-12 col-xs-12"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Component name"),React.createElement("input",{type:"text",onChange:this.nameChanged,value:this.state.name,className:"form-control input-lg",placeholder:"Be creative..."})))}var j="";if(!this.state.loading){j=React.createElement("div",{className:"col-lg-4 col-md-4 col-sm-12 col-xs-12"},React.createElement("div",{className:"form-group"},React.createElement("label",null,"Identifier"),React.createElement("input",{className:"form-control input-lg",type:"text",value:this.state.component.id,onFocus:this.onFocusIdentifier,readOnly:true,placeholder:"Identifier"})))}return React.createElement("div",null,React.createElement("div",{className:"row-fluid"},l,j),React.createElement("div",{className:"row-fluid",id:"inputs"},React.createElement(e,null)),React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},React.createElement("textarea",{id:"code"}))),React.createElement("div",{className:"row-fluid"},React.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12",style:{textAlign:"right"}},k,React.createElement("span",{className:"label label-default",style:{position:"absolute",marginTop:"-18px",right:"19px"}},"Node.JS"))))}})}});